# 股市爬蟲前言

首先，我們使用了xml.etree.ElementTree模組來解析XML文件，並導入了requests、time和openpyxl模組，以支援網路請求、時間延遲和Excel操作等功能。
並且定義了一個名為xml_to_dict的函式，它的作用是將XML元素轉換為字典格式。這在後續將XML資料解析為可操作的結構時非常有用。
接下來定義一個名為fillSheet的函式，用於填充Excel工作表的資料。這個函式接受三個參數：sheet代表要填充的工作表，data表示填充的資料，row代則是填充的起始行。透過enumerate函式，我們可以遍歷資料並將其填充到正確的位置。
再來定義一個名為returnStrDayList的函式，它根據給定的起始年份、月份、結束年份和月份，生成一個包含日期字符串的列表。這個函式用於設定查詢的日期範圍。
在主程式部分，我們首先讀取並解析了XML文件，將其轉換為字典格式的data_dict。然後，我們建立了一個Excel檔案，並創建了一個工作表。使用fillSheet函式，我們將欄位名稱填充到第一行。
接著，根據設定的日期範圍，我們進行了多次股市數據的查詢。使用requests模組，我們向指定的URL發送GET請求，並傳遞相關參數，如回應類型、日期和股票代碼。獲取到的數據以JSON格式返回，我們提取其中的每日股市數據，並使用fillSheet函式將其填充到工作表中。
在每次查詢之間，我們使用time.sleep函式進行延遲，以避免對網站造成過大的負擔。
最後，我們根據XML文件中的設定，將工作表保存為Excel檔案。
這段程式碼可以方便地查詢每日股市數據並保存至Excel檔案，以便進一步分析和追蹤股票的表現和趨勢。通過自定義日期範圍，您可以根據需求查詢特定的時間段內的股市數據。程式的組織結構和流程清晰，使用Python語言實現，具有廣泛的應用價值。

# 如何使用
1. 請先下載exe檔案以及xml檔案
2. 打開xml檔案
3. 輸入正確的股票代碼至stockNo的欄位裡面
4. 輸入欲查詢的時間範圍，共有四個：startYear、startMonth、endYear、endMonth
5. 記得在excelName的欄位上輸入最後輸出的excel檔案名稱
6. 輸入完之後存檔關閉xml
7. 執行exe
8. 最後即可獲得一個整理好報表的excel檔案

# 如果遇到問題
您可以透過email聯絡我

   
   





# stock_crawler
股市爬蟲示範
